[
    {
        "tag":"script",
        "src": "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"
    },
    {
        "tag": "script",
        "innerText": "MathJax = {tex: {inlineMath: [['$', '$']]}};"
    },
    [
        "Discriminative Model $\\frac{\\partial}{\\partial\\theta}\\log p(y|X)$",
        [
            "$$Z(\\theta)=\\sum\\limits_{k}\\exp\\left(f_\\theta^{(k)}(X)\\right)$$",
            "$$p(y|X)=\\frac{\\exp(f_\\theta^{(k)}(X))}{Z(\\theta)}$$",
            "$$\\begin{aligned}\n    \\frac{\\partial}{\\partial\\theta}\\log p(y|X) &= \\frac{\\partial}{\\partial\\theta}\\left(f_\\theta^{(k)}(X) - \\log\\left(Z(\\theta)\\right)\\right)\\\\\n    &= \\frac{\\partial}{\\partial\\theta}f_\\theta^{(k)}(X) - \\frac{1}{Z(\\theta)}\\frac{\\partial}{\\partial\\theta}Z(\\theta)\\\\\n    &= \\frac{\\partial}{\\partial\\theta}f_\\theta^{(k)}(X) - \\frac{1}{Z(\\theta)}\\frac{\\partial}{\\partial\\theta}\\left(\\sum\\limits_{k}\\exp\\left(f_\\theta^{(k)}(X)\\right)\\right)\\\\\n    &= \\frac{\\partial}{\\partial\\theta}f_\\theta^{(k)}(X) - \\sum\\limits_{k'}\\frac{1}{Z(\\theta)}\\frac{\\partial}{\\partial\\theta}\\exp\\left(f_\\theta^{(k')}(X)\\right)\\\\\n    &= \\frac{\\partial}{\\partial\\theta}f_\\theta^{(k)}(X) - \\sum\\limits_{k'}\\frac{\\exp\\left(f_\\theta^{(k')}(X)\\right)}{Z(\\theta)}\\frac{\\partial}{\\partial\\theta}f_\\theta^{(k')}(X)\\\\\n    &= \\frac{\\partial}{\\partial\\theta}f_\\theta^{(k)}(X) - \\sum\\limits_{k'}p_{k'}\\frac{\\partial}{\\partial\\theta}f_\\theta^{(k')}(X)\\\\\n    &= \\sum\\limits_{k'}\\left(1(k=k')-p_{k'}\\right)\\frac{\\partial}{\\partial\\theta}f_\\theta^{(k')}(X)\\\\\n    &= \\frac{\\partial}{\\partial\\theta}f_\\theta(X)^\\top(Y-p)\\\\\n    &= \\frac{\\partial}{\\partial\\theta}f_\\theta(X)^\\top(Y-\\text{E}_\\theta(Y|X))\n   \\end{aligned}$$"
        ]
    ]
]